#!/bin/zsh
#&` define|def->define
#&` redefine|rdef->redefine

definition_dir="definitions"
[ -d "$definition_dir" ] || mkdir -p "$definition_dir"

# define -- defines a word/words using google
function define() #{{{
{
	pushd $definition_dir
	GOOGWORD="http://www.google.com/search?q=define: "
	for word in $@
	do
		if [ ! -f "$word" ];
		then
			lynx --nolist --dump "${GOOGWORD} $word" | tee "${word}.tmp" > "$word"
			sed -i -e '1,/Definitions/d' "$word"
			if [ "$(cat "$word")" = "" ]
			then
				sed -n '/Did you mean:/ s/[^:]*: //p' "${word}.tmp" > "$word"
				if [ "$(cat "$word")" = "" ]
				then
					echo "No definitions found for ${word}. If you think this is a mistake, try 'rdef $word'" > "$word"
				fi
			fi
			rm "${word}.tmp"
		fi
		reply "$(cat "$word")"
	done
	popd
} #}}}

function redefine() #{{{
{
	pushd $definition_dir
	for arg in $@
	do
		if [ -f "$arg" ]
		then
			rm "$arg"
		fi
	done
	popd
	define $*
} #}}}

